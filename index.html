// В секции setTimeout замените на:
async function checkJobStatus(jobId) {
    const response = await fetch(`https://your-supabase-url/rest/v1/jobs?id=eq.${jobId}`, {
        headers: {
            'apikey': 'YOUR_SUPABASE_KEY',
            'Authorization': 'Bearer YOUR_SUPABASE_KEY'
        }
    });
    const data = await response.json();
    return data[0]?.status;
}

pollInterval = setInterval(async () => {
    const status = await checkJobStatus(jobId);
    if (status === 'completed') {
        clearInterval(pollInterval);
        // Открыть результат
    }
}, 10000);
